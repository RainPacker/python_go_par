<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progress</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">  
	<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
     <script src="https://cdn.bootcdn.net/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="progress">
        <div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0;">
          0
        </div>
      </div>
</body>

<script>
     let arr =[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

     async function sleep(delay= 2000){
         return new Promise(reslove=>{
             setTimeout(()=>{
                 reslove();
             },delay)
         })
     }

     async function changeProgress(){

           for(let i =0;i<arr.length;i++){
               let time = Math.random()*5*1000;
               time = Math.floor(time);
               console.log(time);
                await sleep(time);
                
               let bar= document.querySelector(".progress-bar");

               let progress = (i+1)/arr.length*100;
               console.log(progress)
               bar.style.width = progress+"%";
               bar.innerHTML =  Math.round(progress)+"%";
               if(progress == 100){
                   bar.classList.add("progress-bar-success");
                   bar.classList.remove("active");
               }else{
                   bar.classList.add("active")
               }
     }
    }

     changeProgress();


     class Progress {
         constructor(item){
             this.item =item;

         }
         //等同 promise  自动封装成 promise 对象
         then(reslove,reject){
            setTimeout(() =>{reslove("class 中的 then 。。。");},1000)
         }
     }

     async function get(){
       let a =   await new Progress();
       console.log(a);
       throw Error("error")
     }
     get().catch(err=>{
         console.log(err)
     });

</script>
</html>